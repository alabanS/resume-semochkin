<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>E012.A06.TS007 - Кэширование товаров</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Space+Grotesk&display=swap" rel="stylesheet" />
  <style>
    /* Основные стили из вашего API примера */
    body {
      font-family: 'Inter', sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f5f7fa;
    }

    .main-content {
      margin-left: 300px;
      transition: margin-left 0.3s;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 2rem;
    }

    /* Стили документации */
    .api-doc {
      margin-top: 2rem;
    }

    .api-endpoint {
      background-color: #f8f9fa;
      padding: 1rem;
      border-radius: 8px;
      border-left: 4px solid #2196F3;
      margin-bottom: 2rem;
    }

    .api-method {
      font-weight: bold;
      color: #2196F3;
    }

    .api-uri {
      font-family: monospace;
      background-color: #f0f0f0;
      padding: 0.2rem 0.4rem;
      border-radius: 4px;
    }

    .api-description {
      margin: 1rem 0;
      line-height: 1.6;
    }

    .api-section {
      margin-bottom: 2rem;
    }

    .api-section-title {
      font-family: 'Space Grotesk', sans-serif;
      color: #2f4f4f;
      border-bottom: 2px solid #2196F3;
      padding-bottom: 0.5rem;
      margin-bottom: 1rem;
    }

    .api-subsection {
      margin-left: 1rem;
      margin-bottom: 1.5rem;
    }

    .api-subsection-title {
      font-weight: 600;
      color: #2f4f4f;
      margin-bottom: 0.5rem;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin: 1rem 0;
      background-color: rgba(255, 255, 255, 0.7);
      border-radius: 8px;
      overflow: hidden;
    }

    th, td {
      padding: 0.75rem;
      text-align: left;
      border-bottom: 1px solid #ddd;
    }

    th {
      background-color: #2196F3;
      color: white;
    }

    tr:nth-child(even) {
      background-color: rgba(33, 150, 243, 0.1);
    }

    tr:hover {
      background-color: rgba(33, 150, 243, 0.2);
    }

    .code-block {
      background-color: #f5f5f5;
      padding: 1rem;
      border-radius: 8px;
      font-family: monospace;
      white-space: pre-wrap;
      margin: 1rem 0;
      border-left: 4px solid #2196F3;
    }

    .error-table {
      border-left: 4px solid #f44336;
    }

    .error-table th {
      background-color: #f44336;
    }

    .jira-link {
      color: #2196F3;
      text-decoration: none;
    }

    .jira-link:hover {
      text-decoration: underline;
    }

    .load-table {
      border-left: 4px solid #4CAF50;
    }

    .load-table th {
      background-color: #4CAF50;
    }

    /* Стили сайдбара как в API примере */
    .sidebar {
      position: fixed;
      left: -300px;
      top: 0;
      width: 300px;
      height: 100vh;
      background-color: #2c3e50;
      color: white;
      padding: 1rem;
      overflow-y: auto;
      z-index: 1000;
      transition: left 0.3s;
      pointer-events: none;
    }

    .sidebar-trigger {
      position: fixed;
      left: 0;
      top: 50%;
      width: 20px;
      height: 60px;
      background-color: #2c3e50;
      border-top-right-radius: 4px;
      border-bottom-right-radius: 4px;
      cursor: pointer;
      z-index: 999;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      transform: translateY(-50%);
    }

    .sidebar h3 {
      color: white;
      border-bottom: 1px solid #34495e;
      padding-bottom: 0.5rem;
    }

    .sidebar ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .sidebar li {
      margin-bottom: 0.5rem;
    }

    .sidebar a {
      color: #ecf0f1;
      text-decoration: none;
      display: block;
      padding: 0.25rem 0;
    }

    .sidebar a:hover {
      color: #3498db;
    }

    .sidebar ul ul {
      margin-left: 1rem;
      border-left: 1px solid #34495e;
      padding-left: 0.5rem;
    }

    /* Специфичные стили для TS документа */
    .ts-warning {
      background-color: #fff3e0;
      border-left: 4px solid #ff9800;
      padding: 1rem;
      margin: 1rem 0;
    }

    .ts-info {
      background-color: #e3f2fd;
      border-left: 4px solid #2196f3;
      padding: 1rem;
      margin: 1rem 0;
    }

    .ts-success {
      background-color: #e8f5e9;
      border-left: 4px solid #4caf50;
      padding: 1rem;
      margin: 1rem 0;
    }
  </style>
</head>
<body>
  <div class="sidebar-trigger">☰</div>
  <div id="sidebar-container">
    <div class="sidebar">
      <h3>E012.A06.TS007</h3>
      <ul>
        <li><a href="#description">Описание</a></li>
        <li><a href="#e2e">E2E процессы</a></li>
        <li><a href="#architecture">Архитектура</a></li>
        <li><a href="#services">Сервисы</a>
          <ul>
            <li><a href="#service-catalog">Каталог товаров</a></li>
            <li><a href="#service-cache">Сервис кэширования</a></li>
          </ul>
        </li>
        <li><a href="#migration">План миграции</a></li>
        <li><a href="#risks">Риски</a></li>
      </ul>
      <div class="artifacts">
        <h4>Артефакты</h4>
        <ul>
          <li><a href="#" class="jira-link">ADR-042</a></li>
          <li><a href="#" class="jira-link">CAT-42</a></li>
          <li><a href="#" class="jira-link">PERF-15</a></li>
        </ul>
      </div>
    </div>
  </div>

  <main class="main-content">
    <div class="container api-doc">
      <h1>E012.A06.TS007 - Реализация кэширования товаров</h1>

      <div class="ts-warning">
        <p><strong>Внимание!</strong> Перед заполнением шаблона проверьте его актуальность.</p>
        <p>Актуальная версия находится здесь: <a href="#" class="jira-link" target="_blank">E012.A06.TS007</a></p>
      </div>

      <div class="ts-info">
        <p>Данный документ является шаблоном Технического Решения (Technical Solution).</p>
        <p><strong>Technical Solution</strong> - один из артефактов продуктовой архитектуры, описывающий детали решения на уровне разработки.</p>
      </div>

      <div class="api-section" id="description">
        <h2 class="api-section-title">Описание</h2>
        <p>Реализация системы кэширования для каталога товаров с целью повышения производительности и снижения нагрузки на базу данных.</p>

        <table>
          <thead>
            <tr>
              <th>Метрика</th>
              <th>С Technical Solution</th>
              <th>Без Technical Solution</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Информация об изменениях</td>
              <td>Вся информация в одном месте → легче воспринимать</td>
              <td>Информация распределена по задачам, документам и комментариям</td>
            </tr>
            <tr>
              <td>Объяснение изменений</td>
              <td>Показываем Technical Solution</td>
              <td>Показываем различные документы и пишем комментарии</td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="api-section" id="e2e">
        <h2 class="api-section-title">E2E процессы</h2>
        <table>
          <thead>
            <tr>
              <th>Название процесса</th>
              <th>Архитектура</th>
              <th>Статус</th>
              <th>Описание</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Получение каталога товаров</td>
              <td><a href="#" class="jira-link">AV2025.042</a></td>
              <td>Изменяется</td>
              <td>Добавлен шаг проверки кэша перед запросом к БД</td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="api-section" id="architecture">
        <h2 class="api-section-title">Архитектура</h2>
        <p>Изменения в архитектурной схеме продукта:</p>
        <div class="code-block">
// Архитектурная схема будет обновлена
// Добавлен сервис кэширования Redis
// Изменены связи между компонентами
        </div>
        <p>Ссылка на обновленную схему: <a href="#" class="jira-link">Exxx Architecture</a></p>
      </div>

      <div class="api-section" id="services">
        <h2 class="api-section-title">Сервисы</h2>

        <div class="api-subsection" id="service-catalog">
          <h3 class="api-subsection-title">E012.A06.S042 - Каталог товаров</h3>
          <h4>Краткое описание изменений</h4>
          <p>Добавлена проверка кэша перед запросом к базе данных и сохранение результатов в кэш.</p>

          <h4>API-contracts</h4>
          <table>
            <thead>
              <tr>
                <th>Контракт</th>
                <th>Статус</th>
                <th>Описание</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><a href="#" class="jira-link">GET /products</a></td>
                <td>Изменяется</td>
                <td>Добавлен параметр nocache для обхода кэширования</td>
              </tr>
            </tbody>
          </table>

          <h4>PDM</h4>
          <table>
            <thead>
              <tr>
                <th>Таблица</th>
                <th>Статус</th>
                <th>Описание</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><a href="#" class="jira-link">products</a></td>
                <td>Без изменений</td>
                <td>-</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="api-subsection" id="service-cache">
          <h3 class="api-subsection-title">E012.A06.S043 - Сервис кэширования</h3>
          <h4>Краткое описание изменений</h4>
          <p>Новый сервис для хранения кэшированных данных товаров.</p>

          <h4>API-contracts</h4>
          <table>
            <thead>
              <tr>
                <th>Контракт</th>
                <th>Статус</th>
                <th>Описание</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><a href="#" class="jira-link">GET /cache/{key}</a></td>
                <td>Новый</td>
                <td>Получение данных из кэша</td>
              </tr>
              <tr>
                <td><a href="#" class="jira-link">POST /cache</a></td>
                <td>Новый</td>
                <td>Сохранение данных в кэш</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div class="api-section" id="migration">
        <h2 class="api-section-title">План миграции</h2>
        <div class="code-block">
1. Развертывание кластера Redis
2. Деплой новой версии сервиса каталога
3. Наполнение кэша в фоновом режиме
4. Переключение трафика на новую версию
        </div>
      </div>

      <div class="api-section" id="risks">
        <h2 class="api-section-title">Потенциальные проблемы и риски</h2>
        <table class="error-table">
          <thead>
            <tr>
              <th>Риск</th>
              <th>Вероятность</th>
              <th>Воздействие</th>
              <th>Митригация</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Несвоевременное обновление кэша</td>
              <td>Средняя</td>
              <td>Высокая</td>
              <td>Реализовать инвалидацию кэша при изменениях</td>
            </tr>
            <tr>
              <td>Перегрузка Redis</td>
              <td>Низкая</td>
              <td>Критическая</td>
              <td>Мониторинг и автоматическое масштабирование</td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="ts-success">
        <h3>Reviewers</h3>
        <p>@system_analyst OR @senior_developer OR @architect</p>
        <ul>
          <li>Validated: ✓ / ✗</li>
          <li>Date: <time datetime="2025-07-10">10.07.2025</time></li>
        </ul>
      </div>
    </div>
  </main>

  <script>
    // Инициализация сайдбара как в API примере
    document.addEventListener('DOMContentLoaded', function() {
      const sidebar = document.querySelector('.sidebar');
      const sidebarTrigger = document.querySelector('.sidebar-trigger');
      const mainContent = document.querySelector('.main-content');

      let sidebarTimeout;

      function showSidebar() {
        clearTimeout(sidebarTimeout);
        sidebar.style.left = '0';
        sidebar.style.pointerEvents = 'auto';
        mainContent.style.marginLeft = '300px';
      }

      function hideSidebar() {
        sidebarTimeout = setTimeout(() => {
          sidebar.style.left = '-300px';
          sidebar.style.pointerEvents = 'none';
          mainContent.style.marginLeft = '0';
        }, 300);
      }

      if (sidebar && sidebarTrigger) {
        sidebarTrigger.addEventListener('mouseenter', showSidebar);
        sidebar.addEventListener('mouseenter', showSidebar);
        sidebarTrigger.addEventListener('mouseleave', hideSidebar);
        sidebar.addEventListener('mouseleave', hideSidebar);
      }

      // Клик по триггеру на мобильных
      sidebarTrigger.addEventListener('click', function() {
        if (sidebar.style.left === '0px') {
          hideSidebar();
        } else {
          showSidebar();
        }
      });

      // Адаптивность
      function handleResize() {
        if (window.innerWidth <= 768) {
          sidebar.style.left = '-300px';
          mainContent.style.marginLeft = '0';
          sidebarTrigger.style.display = 'flex';
        } else {
          sidebar.style.left = '0';
          mainContent.style.marginLeft = '300px';
          sidebarTrigger.style.display = 'none';
        }
      }

      window.addEventListener('resize', handleResize);
      handleResize();
    });
  </script>
</body>
</html>